{"version":3,"file":"Deferred.js","names":["DeferredPromise","_Promise","_inherits2","_super","_createSuper","resolver","_this","_classCallCheck2","that","call","resolve","reject","Object","assign","_assertThisInitialized2","_createClass2","_wrapNativeSuper2","Promise","exports","DeferredTrigger","_DeferredPromise","_super2","load","_this2","length","_workload","_possibleConstructorReturn2","key","value","trigger","_this3","then","data","reason","Defer","workload","_reject","_resolve","_called","_p","bind","executor","_executor","undefined","promise","called","callback","arguments"],"sources":["../../src/src/Deferred.js"],"sourcesContent":["\n\n/**\n * @desc\n * implements deferred pattern\n * extended promise with exposed resolve and reject handlers\n *\n * passed resolver function\n *\n * @param? {Function} resolver function taking two params: function resolve and function reject\n * \t\tthis parameter is provided as default\n */\nexport class DeferredPromise extends Promise {\n\tconstructor(resolver) {\n\t\tconst that = {};\n\t\tsuper(function(resolve, reject) {\n\t\t\tObject.assign(that, {resolve, reject})\n\t\t});\n\t\tObject.assign(this, that)\n\t\tif (resolver) {\n\t\t\tresolver(this.resolve, this.reject)\n\t\t}\n\t}\n}\n\n/**\n * @desc\n * extended Deferred\n *\n * example:\n * \t\tnew Deferred(() => http.get(url))\n *\n * if we need to pass promise but we do not want to do the actual work yet\n * like e.g. REST calls throttling.\n *\n * @param {Function} takes as argument factory returning promise\n */\nexport class DeferredTrigger extends DeferredPromise {\n\tconstructor(load) {\n\t\tif (load.length == 2) {\n\t\t\tsuper(load);\n\t\t}\n\t\tif (!load.length) {\n\t\t\tsuper(function(resolve, reject) {});\n\t\t\tthis._workload = load \n\t\t}\n\t}\n\n\ttrigger() {\n\t\treturn this._workload()\n\t\t\t.then((data) => {\n\t\t\t\tthis.resolve(data)\n\t\t\t})\n\t\t\t.catch(reason => {\n\t\t\t\tthis.reject(reason)\n\t\t\t})\n\t}\n}\n\n/**\n * @desc\n * defer the execution of the workload\n *\n * @param {Function} factory function returning a Promise (which needs to be deffered)\n *\n * @returns {Objcect} with deferred promise and an executor which triggers the promise fullfillment\n **/\nexport function Defer(workload) {\n\tlet _reject, _resolve, _called;\n\tconst _p = new Promise(function (resolve, reject) {\n\t\t_resolve = resolve;\n\t\t_reject = reject;\n\t}.bind(Defer))\n\n\tconst executor = (function (workload) {\n\t\tlet _executor = undefined;\n\n\t\treturn function() {\n\t\t\t_called = true;\n\t\t\tif (_executor) {\n\t\t\t\treturn _executor;\n\t\t\t}\n\t\t\treturn _executor = workload()\n\t\t\t\t.then(data => {\n\t\t\t\t\t_resolve(data)\n\t\t\t\t})\n\t\t\t\t.catch(reason => {\n\t\t\t\t\t_reject(reason)\n\t\t\t\t})\n\t\t}\n\t})(workload)\n\n\treturn {\n\t\tget promise() { return _p },\n\n\t\tget called() {\n\t\t\treturn _called ? true : false;\n\t\t},\n\n\t    trigger(callback=function() {}) {\n\t\t\texecutor().finally(callback)\n\t\t}\n\t}\n}\n"],"mappings":"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"}