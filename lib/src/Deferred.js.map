{"version":3,"file":"Deferred.js","names":["DeferredPromise","resolver","that","resolve","reject","Object","assign","Promise","DeferredTrigger","load","length","_workload","then","data","reason","Defer","workload","_reject","_resolve","_called","_p","bind","executor","_executor","undefined","promise","called","trigger","callback"],"sources":["../../src/src/Deferred.js"],"sourcesContent":["\n\n/**\n * @desc\n * implements deferred pattern\n * extended promise with exposed resolve and reject handlers\n *\n * passed resolver function\n *\n * @param? {Function} resolver function taking two params: function resolve and function reject\n * \t\tthis parameter is provided as default\n */\nclass DeferredPromise extends Promise {\n\tconstructor(resolver) {\n\t\tconst that = {};\n\t\tsuper(function(resolve, reject) {\n\t\t\tObject.assign(that, {resolve, reject})\n\t\t});\n\t\tObject.assign(this, that)\n\t\tif (resolver) {\n\t\t\tresolver(this.resolve, this.reject)\n\t\t}\n\t}\n}\n\n/**\n * @desc\n * extended Deferred\n *\n * example:\n * \t\tnew Deferred(() => http.get(url))\n *\n * if we need to pass promise but we do not want to do the actual work yet\n * like e.g. REST calls throttling.\n *\n * @param {Function} takes as argument factory returning promise\n */\nclass DeferredTrigger extends DeferredPromise {\n\tconstructor(load) {\n\t\tif (load.length == 2) {\n\t\t\tsuper(load);\n\t\t}\n\t\tif (!load.length) {\n\t\t\tsuper(function(resolve, reject) {});\n\t\t\tthis._workload = load \n\t\t}\n\t}\n\n\ttrigger() {\n\t\treturn this._workload()\n\t\t\t.then((data) => {\n\t\t\t\tthis.resolve(data)\n\t\t\t})\n\t\t\t.catch(reason => {\n\t\t\t\tthis.reject(reason)\n\t\t\t})\n\t}\n}\n\n/**\n * @desc\n * defer the execution of the workload\n *\n * @param {Function} factory function returning a Promise (which needs to be deffered)\n *\n * @returns {Objcect} with deferred promise and an executor which triggers the promise fullfillment\n **/\nexport function Defer(workload) {\n\tlet _reject, _resolve, _called;\n\tconst _p = new Promise(function (resolve, reject) {\n\t\t_resolve = resolve;\n\t\t_reject = reject;\n\t}.bind(Defer))\n\n\tconst executor = (function (workload) {\n\t\tlet _executor = undefined;\n\n\t\treturn function() {\n\t\t\t_called = true;\n\t\t\tif (_executor) {\n\t\t\t\treturn _executor;\n\t\t\t}\n\t\t\treturn _executor = workload()\n\t\t\t\t.then(data => {\n\t\t\t\t\t_resolve(data)\n\t\t\t\t})\n\t\t\t\t.catch(reason => {\n\t\t\t\t\t_reject(reason)\n\t\t\t\t})\n\t\t}\n\t})(workload)\n\n\treturn {\n\t\tget promise() { return _p },\n\n\t\tget called() {\n\t\t\treturn _called ? true : false;\n\t\t},\n\n\t    trigger(callback=function() {}) {\n\t\t\texecutor().finally(callback)\n\t\t}\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA,IAUMA,eAAe;EAAA;EAAA;EACpB,yBAAYC,QAAQ,EAAE;IAAA;IAAA;IACrB,IAAMC,IAAI,GAAG,CAAC,CAAC;IACf,0BAAM,UAASC,OAAO,EAAEC,MAAM,EAAE;MAC/BC,MAAM,CAACC,MAAM,CAACJ,IAAI,EAAE;QAACC,OAAO,EAAPA,OAAO;QAAEC,MAAM,EAANA;MAAM,CAAC,CAAC;IACvC,CAAC;IACDC,MAAM,CAACC,MAAM,gCAAOJ,IAAI,CAAC;IACzB,IAAID,QAAQ,EAAE;MACbA,QAAQ,CAAC,MAAKE,OAAO,EAAE,MAAKC,MAAM,CAAC;IACpC;IAAC;EACF;EAAC;AAAA,iCAV4BG,OAAO;AAarC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA,IAYMC,eAAe;EAAA;EAAA;EACpB,yBAAYC,IAAI,EAAE;IAAA;IAAA;IACjB,IAAIA,IAAI,CAACC,MAAM,IAAI,CAAC,EAAE;MACrB,4BAAMD,IAAI;IACX;IACA,IAAI,CAACA,IAAI,CAACC,MAAM,EAAE;MACjB,4BAAM,UAASP,OAAO,EAAEC,MAAM,EAAE,CAAC,CAAC;MAClC,OAAKO,SAAS,GAAGF,IAAI;IACtB;IAAC;EACF;EAAC;IAAA;IAAA,OAED,mBAAU;MAAA;MACT,OAAO,IAAI,CAACE,SAAS,EAAE,CACrBC,IAAI,CAAC,UAACC,IAAI,EAAK;QACf,MAAI,CAACV,OAAO,CAACU,IAAI,CAAC;MACnB,CAAC,CAAC,SACI,CAAC,UAAAC,MAAM,EAAI;QAChB,MAAI,CAACV,MAAM,CAACU,MAAM,CAAC;MACpB,CAAC,CAAC;IACJ;EAAC;EAAA;AAAA,EAnB4Bd,eAAe;AAsB7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASe,KAAK,CAACC,QAAQ,EAAE;EAC/B,IAAIC,OAAO,EAAEC,QAAQ,EAAEC,OAAO;EAC9B,IAAMC,EAAE,GAAG,IAAIb,OAAO,CAAC,UAAUJ,OAAO,EAAEC,MAAM,EAAE;IACjDc,QAAQ,GAAGf,OAAO;IAClBc,OAAO,GAAGb,MAAM;EACjB,CAAC,CAACiB,IAAI,CAACN,KAAK,CAAC,CAAC;EAEd,IAAMO,QAAQ,GAAI,UAAUN,QAAQ,EAAE;IACrC,IAAIO,SAAS,GAAGC,SAAS;IAEzB,OAAO,YAAW;MACjBL,OAAO,GAAG,IAAI;MACd,IAAII,SAAS,EAAE;QACd,OAAOA,SAAS;MACjB;MACA,OAAOA,SAAS,GAAGP,QAAQ,EAAE,CAC3BJ,IAAI,CAAC,UAAAC,IAAI,EAAI;QACbK,QAAQ,CAACL,IAAI,CAAC;MACf,CAAC,CAAC,SACI,CAAC,UAAAC,MAAM,EAAI;QAChBG,OAAO,CAACH,MAAM,CAAC;MAChB,CAAC,CAAC;IACJ,CAAC;EACF,CAAC,CAAEE,QAAQ,CAAC;EAEZ,OAAO;IACN,IAAIS,OAAO,GAAG;MAAE,OAAOL,EAAE;IAAC,CAAC;IAE3B,IAAIM,MAAM,GAAG;MACZ,OAAOP,OAAO,GAAG,IAAI,GAAG,KAAK;IAC9B,CAAC;IAEEQ,OAAO,qBAAyB;MAAA,IAAxBC,QAAQ,uEAAC,YAAW,CAAC,CAAC;MAChCN,QAAQ,EAAE,WAAQ,CAACM,QAAQ,CAAC;IAC7B;EACD,CAAC;AACF"}